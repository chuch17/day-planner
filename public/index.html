<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Day Planner</title>
    <link rel="stylesheet" href="style.css?v=5">
    <link rel="stylesheet" href="dashboard.css">
    <link rel="stylesheet" href="priority.css">
    <link rel="stylesheet" href="voice.css?v=2">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
</head>
<body>
    <div class="container">
        <!-- New Left Panel: Priority Organizer -->
        <div class="priority-section">
            <!-- Top Half: Active Queue -->
            <div class="priority-half active-half">
                <div class="priority-header-main">
                    <h3>Priority Queue</h3>
                    <span class="live-dot"></span>
                </div>
                <div id="priority-list" class="priority-list">
                    <div class="empty-priority">System Initializing...</div>
                </div>
            </div>
            
            <!-- Bottom Half: Completed History -->
            <div class="priority-half history-half">
                <div class="priority-header-main history-header">
                    <h3>Completed Log</h3>
                    <i class="fas fa-history" style="color: #64748b;"></i>
                </div>
                <div id="priority-history" class="priority-list history-list">
                    <div class="empty-priority">No completed actions yet.</div>
                </div>
            </div>
        </div>

        <!-- Middle: Month Calendar -->
        <div class="calendar-section">
            <header>
                <div class="calendar-navigation">
                    <span id="calendar-prev" class="material-symbols-rounded"><i class="fas fa-chevron-left"></i></span>
                    <p class="calendar-current-date">September 2025</p>
                    <span id="calendar-next" class="material-symbols-rounded"><i class="fas fa-chevron-right"></i></span>
                </div>
            </header>
            
            <div class="calendar-body">
                <ul class="calendar-weekdays">
                    <li>Sun</li>
                    <li>Mon</li>
                    <li>Tue</li>
                    <li>Wed</li>
                    <li>Thu</li>
                    <li>Fri</li>
                    <li>Sat</li>
                </ul>
                <ul class="calendar-dates">
                    <!-- Dates will be generated by JavaScript -->
                </ul>
            </div>

            <!-- Status Dashboard (Option A) -->
            <div class="status-dashboard">
                <div class="current-time-display">
                    <h1 id="clock-time">--:--:--</h1>
                    <p id="clock-date">Loading...</p>
                </div>
                
                <div id="active-event-card" class="active-event-card hidden">
                    <div class="active-header">
                        <span class="live-indicator">● LIVE</span>
                        <span id="active-type">Routine</span>
                    </div>
                    <h3 id="active-title">Drink Water</h3>
                    
                    <div class="timer-display">
                        <span id="event-countdown">00:00</span>
                        <small>remaining</small>
                    </div>

                    <div id="nag-container" class="nag-container hidden">
                        <p>Next Check-in:</p>
                        <span id="nag-countdown">00:00:00</span>
                    </div>
                </div>

                <!-- NEW: Next Event Card -->
                <div id="next-event-card" class="next-event-card hidden">
                    <div class="active-header">
                        <span class="next-indicator">○ UP NEXT</span>
                    </div>
                    <h3 id="next-title">Meeting</h3>
                    <div class="mini-timer">
                        <span id="next-countdown">00:00:00</span>
                        <small>until start</small>
                    </div>
                </div>

                <div id="no-event-msg" class="no-event-msg">
                    <p>No active tasks right now.</p>
                    <small>Enjoy your free time!</small>
                </div>
            </div>
        </div>

        <!-- Right Side: Day Planner View -->
        <div class="day-planner-section">
            <div class="day-header">
                <h2 id="selected-date">Select a date</h2>
                <div class="day-header-actions">
                    <button id="checklist-toggle-btn" class="checklist-btn"><i class="fas fa-list-check"></i> Checklist</button>
                    <button id="open-checklist-creator-btn" class="checklist-add-btn" title="Create New Checklist"><i class="fas fa-plus"></i></button>
                    <button id="add-event-btn" class="add-btn"><i class="fas fa-plus"></i> Add Event</button>
                </div>
            </div>
            <div class="day-view-container">
                <div id="checklist-dropdown" class="checklist-dropdown">
                    <div class="checklist-placeholder">
                        <i class="fas fa-clipboard-list"></i>
                        <h3>Active Checklist</h3>
                        <p>No active checklist for this timeframe, Sir.</p>
                        <div class="ghost-lines">
                            <div class="ghost-line"></div>
                            <div class="ghost-line"></div>
                            <div class="ghost-line"></div>
                        </div>
                    </div>
                </div>
                <div class="day-timeline" id="day-timeline">
                    <!-- 15-minute intervals will be generated here -->
                </div>
            </div>
        </div>

        <!-- Chat Section (New) -->
        <div class="chat-section">
            <div class="chat-header">
                <h3>AI Assistant</h3>
                <span class="status-dot online"></span>
            </div>
            <div id="chat-history" class="chat-history">
                <div class="chat-msg ai">
                    <div class="msg-bubble">
                        Hello! I'm ready to help you plan your day.
                    </div>
                </div>
            </div>
            <div class="chat-input-area">
                <input type="text" id="chat-input" placeholder="Type or speak...">
                <button id="chat-send-btn"><i class="fas fa-paper-plane"></i></button>
            </div>
        </div>
    </div>

    <!-- Add Event Modal -->
    <div id="event-modal" class="modal">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <h2>Add New Event</h2>
            
            <div class="modal-body-layout">
                <!-- Main Form -->
                <form id="event-form" class="event-form-section">
                    <div class="form-group">
                        <label for="event-title">Title</label>
                        <input type="text" id="event-title" placeholder="e.g., Drink Water" required>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="event-time">Time</label>
                            <div class="time-input-group">
                                <select id="event-hour">
                                    <!-- 1-12 -->
                                </select>
                                <select id="event-min">
                                    <!-- 00-59 -->
                                </select>
                                <select id="event-ampm">
                                    <option value="AM">AM</option>
                                    <option value="PM">PM</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="event-end-time">End Time</label>
                            <div class="time-input-group">
                                <select id="event-end-hour">
                                    <!-- 1-12 -->
                                </select>
                                <select id="event-end-min">
                                    <!-- 00-59 -->
                                </select>
                                <select id="event-end-ampm">
                                    <option value="AM">AM</option>
                                    <option value="PM" selected>PM</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Occupies Time Toggle -->
                    <div class="form-group">
                        <label class="toggle-label">
                            Occupies my time?
                            <div class="toggle-switch">
                                <input type="checkbox" id="event-occupies-time" checked>
                                <span class="slider round"></span>
                            </div>
                        </label>
                        <small class="toggle-hint">Turn off for reminders (e.g., Drink Water) that overlap with other tasks.</small>
                    </div>

                    <!-- Reminder / Accountability Settings -->
                    <div class="form-group">
                        <label for="event-reminder-type">Reminders & Accountability</label>
                        <select id="event-reminder-type">
                            <option value="none">None</option>
                            <option value="notify_start">Notify at Start</option>
                            <option value="checkin">Periodic Check-in (Nag Mode)</option>
                        </select>
                    </div>

                    <div id="checkin-settings" class="form-group hidden">
                        <label for="checkin-interval">Check-in Interval</label>
                        <select id="checkin-interval">
                            <option value="5">Every 5 minutes</option>
                            <option value="10">Every 10 minutes</option>
                            <option value="15">Every 15 minutes</option>
                            <option value="30">Every 30 minutes</option>
                        </select>
                        <small class="toggle-hint">System will ask "Did you complete this?" until you say Yes.</small>
                    </div>

                    <!-- Event Type (Symbol) -->
                    <div class="form-group">
                        <label>Event Type (Behavior)</label>
                        <div class="type-selector">
                            <label class="type-option">
                                <input type="radio" name="event-type" value="fixed" checked>
                                <span class="type-box"><i class="fas fa-lock"></i> Fixed</span>
                            </label>
                            <label class="type-option">
                                <input type="radio" name="event-type" value="flexible">
                                <span class="type-box"><i class="fas fa-water"></i> Flexible</span>
                            </label>
                            <label class="type-option">
                                <input type="radio" name="event-type" value="routine">
                                <span class="type-box"><i class="fas fa-sync-alt"></i> Routine</span>
                            </label>
                            <label class="type-option">
                                <input type="radio" name="event-type" value="deadline">
                                <span class="type-box"><i class="fas fa-flag"></i> Deadline</span>
                            </label>
                            <label class="type-option">
                                <input type="radio" name="event-type" value="blocker">
                                <span class="type-box"><i class="fas fa-ban"></i> Blocker</span>
                            </label>
                        </div>
                    </div>

                    <!-- Recurrence Settings (Hidden by default) -->
                    <div id="recurrence-section" class="recurrence-section hidden">
                        <h4>Recurrence Pattern</h4>
                        <div class="recurrence-row">
                            <label>Repeat every:</label>
                            <input type="number" id="recurrence-interval" value="1" min="1" style="width: 60px;">
                            <select id="recurrence-unit">
                                <option value="days">Days</option>
                                <option value="weeks">Weeks</option>
                            </select>
                        </div>
                        
                        <div id="recurrence-days" class="recurrence-days hidden">
                            <label>On days:</label>
                            <div class="week-days-selector">
                                <label><input type="checkbox" value="0"> S</label>
                                <label><input type="checkbox" value="1"> M</label>
                                <label><input type="checkbox" value="2"> T</label>
                                <label><input type="checkbox" value="3"> W</label>
                                <label><input type="checkbox" value="4"> T</label>
                                <label><input type="checkbox" value="5"> F</label>
                                <label><input type="checkbox" value="6"> S</label>
                            </div>
                        </div>

                        <div class="recurrence-row">
                            <label>Ends on:</label>
                            <input type="date" id="recurrence-end">
                        </div>
                    </div>

                    <!-- Event Category (Color Picker) -->
                    <div class="form-group">
                        <label for="event-color">Category Color</label>
                        <div class="color-picker-container">
                            <input type="color" id="event-color" name="event-color" value="#6332c5">
                            <span class="color-help">Pick a color for this event category</span>
                        </div>
                    </div>

                    <div class="form-actions">
                         <label class="save-template-option">
                            <input type="checkbox" id="save-as-template"> Save to Templates
                        </label>
                        <button type="submit" class="save-btn">Save Event</button>
                    </div>
                </form>

                <!-- Templates Sidebar -->
                <div class="templates-section">
                    <h3>Saved Templates</h3>
                    <div id="templates-list" class="templates-list">
                        <!-- Templates will be injected here -->
                        <div class="empty-templates">No saved templates yet.</div>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <!-- Event Action Modal -->
    <div id="action-modal" class="modal">
        <div class="modal-content action-content">
            <span class="close-modal close-action">&times;</span>
            <h3 id="action-title">Event Title</h3>
            <div class="action-buttons">
                <button id="action-edit" class="action-btn edit"><i class="fas fa-edit"></i> Edit</button>
                <button id="action-delay" class="action-btn delay"><i class="fas fa-forward"></i> Smart Delay (Next Free)</button>
                <button id="action-delete" class="action-btn delete"><i class="fas fa-trash"></i> Delete</button>
            </div>
        </div>
    </div>

    <!-- Checklist Creator Modal -->
    <div id="checklist-creator-modal" class="modal">
        <div class="modal-content creator-modal-content">
            <span class="close-modal close-creator">&times;</span>
            
            <!-- NEW: Thinking Lab Overlay -->
            <div id="thinking-lab-overlay" class="thinking-lab-overlay hidden">
                <div class="lab-content">
                    <div class="neural-orb">
                        <div class="orb-core"></div>
                        <div class="orb-ring"></div>
                        <div class="orb-ring"></div>
                    </div>
                    <h3>AI Thinking Lab</h3>
                    <p id="lab-status">Initializing procedural forge...</p>
                    
                    <div id="lab-log-container" class="lab-log-container">
                        <div id="lab-log" class="lab-log">
                            <!-- Detailed log entries will appear here -->
                        </div>
                    </div>

                    <div class="progress-steps-compact">
                        <div class="step-dot" id="dot-analyze"></div>
                        <div class="step-dot" id="dot-forge"></div>
                        <div class="step-dot" id="dot-sync"></div>
                    </div>
                </div>
            </div>

            <h2>Checklist Creator</h2>
            <div class="creator-layout">
                <!-- Left: Input Lab -->
                <div class="creator-lab">
                    <div class="form-group">
                        <label for="checklist-name">Checklist Title</label>
                        <input type="text" id="checklist-name" placeholder="e.g., Morning Routine" required>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>Start Time</label>
                            <div class="time-input-group">
                                <select id="checklist-start-hour"></select>
                                <select id="checklist-start-min"></select>
                                <select id="checklist-start-ampm">
                                    <option value="AM">AM</option>
                                    <option value="PM">PM</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>End Time</label>
                            <div class="time-input-group">
                                <select id="checklist-end-hour"></select>
                                <select id="checklist-end-min"></select>
                                <select id="checklist-end-ampm">
                                    <option value="AM">AM</option>
                                    <option value="PM" selected>PM</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>Event Type (Behavior)</label>
                        <div class="type-selector">
                            <label class="type-option">
                                <input type="radio" name="checklist-type" value="fixed" checked>
                                <span class="type-box"><i class="fas fa-lock"></i> Fixed</span>
                            </label>
                            <label class="type-option">
                                <input type="radio" name="checklist-type" value="routine">
                                <span class="type-box"><i class="fas fa-sync-alt"></i> Routine</span>
                            </label>
                        </div>
                    </div>

                    <!-- Checklist Recurrence Settings -->
                    <div id="checklist-recurrence-section" class="recurrence-section hidden">
                        <h4>Recurrence Pattern</h4>
                        <div class="recurrence-row">
                            <label>Repeat every:</label>
                            <input type="number" id="checklist-recurrence-interval" value="1" min="1" style="width: 60px;">
                            <select id="checklist-recurrence-unit">
                                <option value="days">Days</option>
                                <option value="weeks">Weeks</option>
                            </select>
                        </div>
                        
                        <div id="checklist-recurrence-days" class="recurrence-days hidden">
                            <label>On days:</label>
                            <div class="week-days-selector" id="checklist-week-days">
                                <label><input type="checkbox" value="0"> S</label>
                                <label><input type="checkbox" value="1"> M</label>
                                <label><input type="checkbox" value="2"> T</label>
                                <label><input type="checkbox" value="3"> W</label>
                                <label><input type="checkbox" value="4"> T</label>
                                <label><input type="checkbox" value="5"> F</label>
                                <label><input type="checkbox" value="6"> S</label>
                            </div>
                        </div>

                        <div class="recurrence-row">
                            <label>Ends on:</label>
                            <input type="date" id="checklist-recurrence-end">
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="checklist-item-input">Add New Item</label>
                        <div class="item-input-group">
                            <input type="text" id="checklist-item-input" placeholder="Type a task and press Enter...">
                            <button id="add-item-to-preview-btn" class="item-add-btn"><i class="fas fa-plus"></i></button>
                        </div>
                    </div>

                    <div class="creator-templates-section">
                        <label>Quick Load Saved Checklist</label>
                        <div id="creator-saved-list" class="creator-saved-list">
                            <!-- Saved checklist templates will appear here -->
                            <div class="empty-saved">No saved checklists yet.</div>
                        </div>
                    </div>

                    <div class="creator-actions">
                         <label class="save-template-option">
                            <input type="checkbox" id="save-checklist-as-template"> Save to Templates
                        </label>
                        <button id="deploy-checklist-btn" class="deploy-btn"><i class="fas fa-rocket"></i> Deploy to Calendar</button>
                    </div>
                </div>

                <!-- Right: Live Preview -->
                <div class="creator-preview">
                    <div class="preview-header">
                        <h3>Live Preview</h3>
                        <span id="preview-item-count" class="item-count">0 items</span>
                    </div>
                    <div id="checklist-preview-list" class="preview-list">
                        <div class="empty-preview-msg">
                            <i class="fas fa-list-ul"></i>
                            <p>Your checklist items will appear here.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Voice Interaction Orb -->
    <div id="voice-orb" class="voice-orb">
        <i class="fas fa-microphone"></i>
        <div class="voice-ripple"></div>
    </div>

    <script src="script.js?v=2"></script>
    <script src="checklist.js?v=2"></script>
    <script src="priority.js?v=2"></script>
    <script src="dashboard.js?v=2"></script>
    <script src="notifications.js"></script>
    <script src="voice.js"></script>
</body>
</html>